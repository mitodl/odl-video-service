{% extends "base.html" %}
{% load render_bundle %}

{% block title %}Login{% endblock %}
{% block pagetitle %}Login{% endblock %}
{% block content %}

{% if use_keycloak %}

  <div class="login-container">
    <h2>Redirecting to Login...</h2>
    <p>You will be redirected to the authentication page automatically.</p>
    <p>If you are not redirected, <a href="{% url 'social:begin' 'keycloak' %}">click here</a>.</p>
  </div>
  <script>
    // Automatically redirect to Keycloak login
    window.location.href = "{% url 'social:begin' 'keycloak' %}";
  </script>
  <style>
  .login-container {
    max-width: 400px;
    margin: 50px auto;
    padding: 20px;
    text-align: center;
    border: 1px solid #ddd;
    border-radius: 5px;
  }
  </style>

{% else %}
  {% if form.errors %}
    <p>Your username and password didn't match. Please try again.</p>
  {% endif %}
    <form method="post" action="{% url 'login' %}">
    {% csrf_token %}
    <table>
      <tr>
          <td>{{ form.username.label_tag }}</td>
          <td>{{ form.username }}</td>
      </tr>
      <tr>
          <td>{{ form.password.label_tag }}</td>
          <td>{{ form.password }}</td>
      </tr>
    </table>

    <input type="submit" value="Login" />
    <input type="hidden" name="next" value="{{ next }}" />
  </form>
{% endif %}

{% endblock %}
